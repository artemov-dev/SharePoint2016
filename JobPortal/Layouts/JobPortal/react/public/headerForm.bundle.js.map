{"version":3,"sources":["webpack:///./src/Header/headerEditPanel.scss","webpack:///./src/Header/HeadEditPanel.tsx","webpack:///./src/Header/headerForm.js","webpack:///./src/Header/headerEditPanel.scss?ca87","webpack:///./src/ArtDevServices.js"],"names":["___CSS_LOADER_EXPORT___","push","module","i","HeadEditPanel","React","useState","NavLink","setNavLink","items","setitems","useEffect","SPServices","getJsomListItems","then","data","LinkTop","filter","value","Menu2Level","map","name","Title","url","MenuLink","id","ID","edit","ordernum","MenuOrderNumber","links","TopLink","_onClickSaveIcon","e","forEach","link1","currentTarget","link2","_onClickRemoveIcon","NavLinkNew","_onClickAddIcon","EmptyLink","shift","console","log","_onChangeTextField","element","target","title","navLinkGroups","Stack","tokens","maxWidth","Nav","ariaLabel","groups","onRenderLink","props","menuProps","key","text","iconProps","iconName","onClick","horizontal","className","AnimationClassNames","slideRightIn400","verticalAlign","Label","IconButton","TextField","defaultValue","disabled","onChange","styles","root","padding","autoComplete","onLinkClick","tag","tagName","getElementsByTagName","length","preventDefault","horizontalAlign","DefaultButton","initializeIcons","disableWarnings","ReactDOM","render","document","getElementById","options","locals","priv","lastStatusId","undefined","getWebUrl","_spPageContextInfo","webServerRelativeUrl","checkAttachments","context","enumerator","item","Promise","resolve","Attachments","attachmentFiles","get_current","get_attachmentFiles","reject","load","executeQueryAsync","attachmentsItemsEnumerator","getEnumerator","moveNext","attachItem","AttachmentFiles","FileName","get_fileName","ServerRelativeUrl","get_serverRelativeUrl","sender","error","get_message","get_stackTrace","getAttachments","getLink","link","linkUrl","Url","search","split","getSiteUrl","siteServerRelativeUrl","getStringParamsFromObject","paramsObject","Object","keys","k","encodeURI","join","getWebApiUrlList","listUrl","webUrl","isImage","fileName","test","getUrlParameterByName","window","location","href","replace","results","RegExp","exec","decodeURIComponent","getListItemById","itemId","createListItem","deferred","jQuery","Deferred","fetch","method","headers","val","body","JSON","stringify","response","json","d","promise","deleteListItem","updateListItem","listTitle","camlQuery","params","pagingInfo","SP","ClientContext","list","get_web","get_lists","getByTitle","query","CamlQuery","set_viewXml","position","ListItemCollectionPosition","set_pagingInfo","set_listItemCollectionPosition","listItems","getItems","promises","get_fieldValues","extend","all","isUserInGroups","userGroups","indexOf","addNotification","fixed","UI","Notify","Status","removeStatus","getTarget","getHashTagLink","hashTagId","hslToRgb","h","s","l","r","g","b","hue2rgb","p","q","t","Math","floor","setCookie","szName","szValue","uDaysExpires","szPath","szExpireDate","dtExpires","Date","setTime","getTime","toGMTString","cookie","getCookie","matches","match","getSetting","callback","SOD","executeFunc","SettingsValue","isInEditMode","inDesignMode","forms","MSOWebPartPageFormName","MSOLayout_InDesignMode","wikiInEditMode","_wikiPageMode","OpenModalDialog","strPageURL","width","height","dialogOptions","$create_DialogOptions","ModalDialog","showModalDialog"],"mappings":"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","file":"headerForm.bundle.js","sourcesContent":["// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"button{min-width:0}a:visited{color:unset;text-decoration:none}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/Header/headerEditPanel.scss\"],\"names\":[],\"mappings\":\"AAAA,OACI,WAAA,CAGJ,UACI,WAAA,CACA,oBAAA\",\"sourcesContent\":[\"button {\\r\\n    min-width:0;\\r\\n}\\r\\n\\r\\na:visited {\\r\\n    color: unset;\\r\\n    text-decoration: none;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","import * as React from 'react';\r\nimport './headerEditPanel.scss';\r\nimport { SPServices } from '../ArtDevServices';\r\nimport { Nav, INavLinkGroup, INavLink } from 'office-ui-fabric-react/lib/Nav';\r\nimport { DefaultButton, IconButton, IContextualMenuProps, IIconProps, Label, Stack, TextField, values } from 'office-ui-fabric-react';\r\nimport { AnimationClassNames } from 'office-ui-fabric-react/lib/Styling';\r\n\r\n\r\ninterface IHeadMenu {\r\n  ID: string,\r\n  Title: string,\r\n  Menu2Level: string,\r\n  MenuLink: string,\r\n  MenuOrderNumber: string\r\n}\r\n\r\n\r\n\r\nexport const HeadEditPanel: React.FunctionComponent = () => {\r\n  const [NavLink, setNavLink] = React.useState<INavLink[] | []>([])\r\n  const [items, setitems] = React.useState<IHeadMenu[] | []>([])\r\n\r\n  React.useEffect(() => {\r\n    SPServices.getJsomListItems(\"\", \"ArtDev меню\", \"<View Scope='RecursiveAll'><Query><OrderBy><FieldRef Name='MenuOrderNumber' Ascending='TRUE' /></OrderBy></Query></View>\")\r\n      .then(data => setitems(data))\r\n  }, [])\r\n\r\n  React.useEffect(() => {\r\n    const LinkTop: INavLink[] = items.filter((value: IHeadMenu) => {\r\n      return value.Menu2Level == null\r\n    }).map(value => {\r\n      return { name: value.Title, url: value.MenuLink, id: value.ID, edit: false, ordernum: value.MenuOrderNumber, links: [] }\r\n    })\r\n    LinkTop.map((TopLink: INavLink) => {\r\n      return items.filter((value: IHeadMenu) => {\r\n        return value.Title == TopLink.name && value.Menu2Level != null\r\n      }).map(value => {\r\n        TopLink.links?.push({ name: value.Menu2Level, url: value.MenuLink, id: value.ID, edit: false, ordernum: value.MenuOrderNumber, links: [] })\r\n      })\r\n    })\r\n    setNavLink(LinkTop)\r\n  }, [items])\r\n\r\n  const _onClickHandler = (e: React.MouseEvent<HTMLElement, MouseEvent>) => {\r\n    const tag: string = (e.target as HTMLInputElement).tagName\r\n    if (tag == 'SPAN' || tag == 'LABEL') {\r\n      const id: string = e.currentTarget.getElementsByTagName('label').length ?\r\n        e.currentTarget.getElementsByTagName('label')[0].id :\r\n        e.currentTarget.getElementsByTagName('button')[0].id\r\n\r\n      NavLink.forEach((link1: INavLink) => {\r\n        link1.id == id ? link1.edit = !link1.edit : null\r\n        link1.links?.forEach((link2: INavLink) => {\r\n          link2.id == id ? link2.edit = !link2.edit : null\r\n        })\r\n      })\r\n    }\r\n    e.preventDefault()\r\n  }\r\n\r\n\r\n  const _onClickSaveIcon = (e: React.MouseEvent<HTMLElement>) => {\r\n    NavLink.forEach((link1: INavLink) => {\r\n      link1.id == e.currentTarget.id ? link1.edit = !link1.edit : null\r\n      link1.links?.forEach((link2: INavLink) => {\r\n        link2.id == e.currentTarget.id ? link2.edit = !link2.edit : null\r\n      })\r\n    })\r\n  }\r\n\r\n  const _onClickRemoveIcon = (e: React.MouseEvent<HTMLElement>) => {\r\n    const NavLinkNew = NavLink.filter((link1: INavLink) => {\r\n      link1.links = link1.links?.filter((link2: INavLink) => {\r\n        return link2.id != e.currentTarget.id\r\n      })\r\n      return link1.id != e.currentTarget.id\r\n    })\r\n    setNavLink(NavLinkNew)\r\n\r\n  }\r\n\r\n  const _onClickAddIcon = (e: React.MouseEvent<HTMLElement>) => {\r\n    \r\n    \r\n    const EmptyLink: INavLink = { name: '', url: '', ordernum: 0, edit: true, links: [] }\r\n    NavLink.forEach((link1: INavLink) => {\r\n\r\n      let shift: boolean = false;\r\n      link1.links?.forEach((link2: INavLink) => {\r\n        if (e.currentTarget.id == link2.id) {\r\n          shift = true;\r\n          EmptyLink.ordernum = link2.ordernum\r\n          link1.links?.push(EmptyLink)\r\n        }\r\n        shift ? link2.ordernum = link2.ordernum + 1: null\r\n\r\n      })\r\n    })\r\n\r\n\r\n    console.log(NavLink)\r\n  }\r\n\r\n  const _onChangeTextField = (e: React.FormEvent<HTMLInputElement>) => {\r\n    const element = e.target as HTMLInputElement\r\n    NavLink.forEach((link1: INavLink) => {\r\n      if (link1.id == element.id) { element.title == \"url\" ? link1.url = element.value : link1.name = element.value; }\r\n      link1.links?.forEach((link2: INavLink) => {\r\n        if (link2.id == element.id) { element.title == \"url\" ? link2.url = element.value : link2.name = element.value; }\r\n      })\r\n    })\r\n  }\r\n\r\n\r\n  let navLinkGroups: INavLinkGroup[] = [\r\n    {\r\n      links: NavLink\r\n    }\r\n  ]\r\n\r\n\r\n\r\n  const RenderLink = (props: INavLink) => {\r\n\r\n    const saveIcon: IIconProps = { iconName: 'Save' };\r\n    const ChevronDownIcon: IIconProps = { iconName: 'ChevronDown' }\r\n    const ChevronUpIcon: IIconProps = { iconName: 'ChevronUp' }\r\n\r\n\r\n    const menuProps: IContextualMenuProps = {\r\n      items: [\r\n        {\r\n          id: props.id,\r\n          key: 'Add',\r\n          text: 'Add',\r\n          iconProps: { iconName: 'Add' },\r\n          onClick: _onClickAddIcon\r\n        },\r\n        {\r\n          id: props.id,\r\n          key: 'Remove',\r\n          text: 'Remove',\r\n          iconProps: { iconName: 'Remove' },\r\n          onClick: _onClickRemoveIcon\r\n        },\r\n      ],\r\n    };\r\n\r\n    return (\r\n      <>\r\n        <Stack horizontal className={AnimationClassNames.slideRightIn400} verticalAlign='center' >\r\n          {!props.edit &&\r\n            <>\r\n              <Label id={props.id}>{props.name}</Label>\r\n              <IconButton iconProps={ChevronUpIcon} id={props.id} onClick={() => { }} />\r\n              <IconButton iconProps={ChevronDownIcon} id={props.id} onClick={() => { }} />\r\n            </>\r\n          }\r\n          {props.edit &&\r\n            <>\r\n              <TextField defaultValue={props.name} disabled={props.edit ? false : true} id={props.id} title=\"name\" onChange={_onChangeTextField} styles={{ root: { padding: 20 } }} autoComplete=\"off\" />\r\n              <TextField defaultValue={props.url} disabled={props.edit ? false : true} id={props.id} title=\"url\" onChange={_onChangeTextField} autoComplete=\"off\" />\r\n            </>\r\n          }\r\n        </Stack>\r\n        {props.edit &&\r\n          <>\r\n            <IconButton iconProps={saveIcon} id={props.id} onClick={_onClickSaveIcon} />\r\n            <IconButton menuProps={menuProps} />\r\n          </>\r\n        }\r\n      </>\r\n\r\n    )\r\n  }\r\n\r\n\r\n\r\n\r\n  return (\r\n    <Stack tokens={{ maxWidth: 600 }}>\r\n      <Nav\r\n        ariaLabel=\"Head Edit Panel\"\r\n        groups={navLinkGroups}\r\n        onRenderLink={RenderLink}\r\n        onLinkClick={_onClickHandler}\r\n      />\r\n      <Stack horizontal horizontalAlign=\"end\"  >\r\n        <DefaultButton text=\"Сохранить\" onClick={() => { }} />\r\n      </Stack>\r\n    </Stack>\r\n\r\n  )\r\n};\r\n","import * as React from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport { HeadEditPanel } from './HeadEditPanel'\r\nimport { initializeIcons } from 'office-ui-fabric-react';\r\ninitializeIcons('/_layouts/15/JobPortal/react/public/fluenticons/', { disableWarnings: true });\r\n\r\n\r\n    ReactDOM.render(\r\n        <HeadEditPanel />,\r\n        document.getElementById(\"headerForm\")\r\n    )\r\n    \r\n\r\n","import api from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js??ref--6-2!./headerEditPanel.scss\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","/* =============================================================\r\n Author\t\t\t:\tArtemov Aleksandr\r\n Create date\t:\t15.01.2021\r\n Description\t:\tСистемные функции\r\n =============================================================== */\r\n\r\n\r\n\r\nexport const SPServices = (function () {\r\n\r\n    var priv = { lastStatusId: undefined };\r\n    // Получаем адрес сайта\r\n    function getWebUrl() {\r\n        return (_spPageContextInfo.webServerRelativeUrl == '/') ? '' : _spPageContextInfo.webServerRelativeUrl;\r\n    }\r\n\r\n    // Получаем адрес коллекции сайта\r\n    function getSiteUrl() {\r\n        return _spPageContextInfo.siteServerRelativeUrl;\r\n    }\r\n\r\n    // Перевод объекта в строку параметров типа 'param1=value1&param2=value2'\r\n    function getStringParamsFromObject(paramsObject) {\r\n        return Object.keys(paramsObject).map(function (k) {\r\n            return encodeURI(k) + '=' + encodeURI(paramsObject[k]);\r\n        }).join('&');\r\n    }\r\n\r\n    // Формирует URL для запроса получения элементов списка через REST\r\n    function getWebApiUrlList(listUrl) {\r\n        var webUrl = getWebUrl();\r\n        return webUrl + '/_api/web/getList(\\'' + webUrl + listUrl + '\\')/items?';\r\n    }\r\n\r\n    // Проверяем что аттач это картинка\r\n    function isImage(fileName) {\r\n        return /(\\.jpg|\\.jpeg|\\.png|\\.bmp|\\.svg)$/i.test(fileName);\r\n    }\r\n\r\n    // Получение значения параметра URL'а по его имени\r\n    function getUrlParameterByName(name) {\r\n        var url = window.location.href;\r\n        name = name.replace(/[\\[\\]]/g, \"\\\\$&\");\r\n        var regex = new RegExp(\"[?&]\" + name + \"(=([^&#]*)|&|#|$)\"), results = regex.exec(url);\r\n        if (!results) {\r\n            return null\r\n        }\r\n\r\n        if (!results[2]) {\r\n            return '';\r\n        }\r\n\r\n        return decodeURIComponent(results[2].replace(/\\+/g, \" \"));\r\n    }\r\n\r\n    // Формирует URL для запроса получения элемента списка по ID для REST\r\n    function getListItemById(listUrl, itemId) {\r\n        var webUrl = getWebUrl();\r\n        return webUrl + '/_api/web/getList(\\'' + webUrl + listUrl + '\\')/items(' + itemId + ')';\r\n    }\r\n\r\n    // Создание элемента в списке\r\n    function createListItem(listUrl, data) {\r\n        var deferred = jQuery.Deferred();\r\n\r\n        var webUrl = getWebUrl();\r\n        fetch(webUrl + \"/_api/web/getList('\" + webUrl + listUrl + \"')/items\", {\r\n            method: 'POST',\r\n            headers: {\r\n                'Accept': \"application/json;odata=verbose\",\r\n                'Content-Type': \"application/json;odata=verbose\",\r\n                'X-RequestDigest': jQuery(\"#__REQUESTDIGEST\").val()\r\n            },\r\n            body: JSON.stringify(data)\r\n        })\r\n            .then(function (response) {\r\n                return response.json();\r\n            })\r\n            .then(function (data) {\r\n                deferred.resolve(data.d);\r\n            })\r\n            .catch(function (error) {\r\n                deferred.reject(error);\r\n                console.log('Не удалась создать элемент', error);\r\n            });\r\n\r\n        return deferred.promise();\r\n    }\r\n\r\n    // Удаление элемента из списка\r\n    function deleteListItem(listUrl, itemId) {\r\n        var deferred = jQuery.Deferred();\r\n\r\n        var webUrl = getWebUrl();\r\n        fetch(webUrl + \"/_api/web/getList('\" + webUrl + listUrl + \"')/items(\" + itemId + \")\", {\r\n            method: 'DELETE',\r\n            headers: {\r\n                'Accept': \"application/json;odata=verbose\",\r\n                'Content-Type': \"application/json;odata=verbose\",\r\n                'X-RequestDigest': jQuery(\"#__REQUESTDIGEST\").val(),\r\n                'IF-MATCH': \"*\"\r\n            }\r\n        })\r\n            .then(function (data) {\r\n                deferred.resolve(data);\r\n            })\r\n            .catch(function (error) {\r\n                deferred.reject(error);\r\n                console.log('Не удалась удалить элемент', error);\r\n            });\r\n\r\n        return deferred.promise();\r\n    }\r\n\r\n    function updateListItem(listUrl, itemId, data) {\r\n        return new Promise(function (resolve, reject) {\r\n            var webUrl = getWebUrl();\r\n\r\n            fetch(webUrl + \"/_api/web/getList('\" + webUrl + listUrl + \"')/items(\" + itemId + \")\", {\r\n                method: \"POST\",\r\n                headers: {\r\n                    'Accept': \"application/json;odata=verbose\",\r\n                    'Content-Type': \"application/json;odata=verbose\",\r\n                    'X-RequestDigest': jQuery(\"#__REQUESTDIGEST\").val(),\r\n                    'IF-MATCH': \"*\",\r\n                    'X-Http-Method': \"MERGE\"\r\n                },\r\n                body: JSON.stringify(data)\r\n            })\r\n                .then(function (response) {\r\n                    resolve(response);\r\n                })\r\n                .catch(function (error) {\r\n                    reject(error);\r\n                    console.log('Не удалась обновить элемент');\r\n                });\r\n        });\r\n    }\r\n\r\n\r\n    function getJsomListItems(webUrl, listTitle, camlQuery, params, pagingInfo) {\r\n        // Возращаем promise чтобы снабдить функцию функционалом обещаний\r\n        return new Promise(function (resolve, reject) {        \r\n                var context = SP.ClientContext.get_current();;//new SP.ClientContext(webUrl); TODO: не открывать контекст, если подходит текущий\r\n                var list = context.get_web().get_lists().getByTitle(listTitle);\r\n                var query = new SP.CamlQuery();\r\n                query.set_viewXml(camlQuery);\r\n\r\n                if (pagingInfo) {\r\n                    var position = new SP.ListItemCollectionPosition();\r\n                    position.set_pagingInfo(pagingInfo);\r\n                    query.set_listItemCollectionPosition(position);\r\n                }\r\n\r\n                var listItems = list.getItems(query);\r\n                if (params) {\r\n                    context.load(listItems, params);\r\n                } else {\r\n                    context.load(listItems);\r\n                }\r\n\r\n                context.executeQueryAsync(function () {\r\n                    // var items = [];\r\n                    var enumerator = listItems.getEnumerator();\r\n\r\n                    var promises = [];\r\n                    while (enumerator.moveNext()) {\r\n                        var item = enumerator.get_current().get_fieldValues();\r\n                        jQuery.extend(item, { AttachmentFiles: [] });\r\n\r\n                        var promise = checkAttachments(context, enumerator, item);\r\n                        promises.push(promise);\r\n                    }\r\n\r\n                    Promise.all(promises)\r\n                        .then(function (data) {\r\n                            resolve(data);\r\n                        });\r\n\r\n                }, function (sender, error) {\r\n                    reject(error.get_message(), error.get_stackTrace());\r\n                });\r\n            });       \r\n    }\r\n\r\n    function checkAttachments(context, enumerator, item) {\r\n        return new Promise(function (resolve) {\r\n            if (item.Attachments) {\r\n                var attachmentFiles = enumerator.get_current().get_attachmentFiles();\r\n                getAttachments(context, attachmentFiles, item)\r\n                    .then(function (data) {\r\n                        resolve(data);\r\n                    });\r\n            } else {\r\n                resolve(item);\r\n            }\r\n        });\r\n    }\r\n\r\n    function getAttachments(context, attachmentFiles, item) {\r\n        return new Promise(function (resolve, reject) {\r\n            context.load(attachmentFiles);\r\n            context.executeQueryAsync(function () {\r\n                var attachmentsItemsEnumerator = attachmentFiles.getEnumerator();\r\n                while (attachmentsItemsEnumerator.moveNext()) {\r\n                    var attachItem = attachmentsItemsEnumerator.get_current();\r\n\r\n                    item.AttachmentFiles.push({\r\n                        FileName: attachItem.get_fileName(),\r\n                        ServerRelativeUrl: attachItem.get_serverRelativeUrl()\r\n                    });\r\n                }\r\n\r\n                resolve(item);\r\n            }, function (sender, error) {\r\n                reject(error.get_message(), error.get_stackTrace());\r\n            });\r\n        });\r\n    }\r\n\r\n    // Определить, состоит ли текущий пользователь в указанных группах\r\n    function isUserInGroups(userGroups) {\r\n        // Возращаем promise чтобы снабдить функцию функционалом обещаний\r\n        return new Promise(function (resolve) {\r\n\r\n            if (userGroups === undefined) {\r\n                userGroups = [];\r\n            }\r\n\r\n            // Добавляем по умолчанию группу системных администраторов\r\n            // userGroups.push(SLSystemConstants.SYSTEM_ADMINISTRATOR_GROUP);\r\n\r\n            var url = getWebUrl() + '/_api/web/currentuser/groups';\r\n\r\n            fetch(url, {\r\n                headers: {\r\n                    'Accept': \"application/json;odata=verbose\",\r\n                    'Content-Type': \"application/json;odata=verbose\",\r\n                }\r\n            })\r\n                .then(function (response) {\r\n                    return response.json();\r\n                })\r\n                .then(function (response) {\r\n                    response.d.results.map(function (item) {\r\n                        if (userGroups.indexOf(item.Title) != -1) {\r\n                            resolve(true);\r\n                        }\r\n                    });\r\n                    resolve(false);\r\n                })\r\n                .catch(function (error) {\r\n                    console.log('Ошибка при проверке групп пользователя', error);\r\n                });\r\n        });\r\n    }\r\n\r\n\r\n    function addNotification(text, fixed) {\r\n        if (SP.UI.Notify) {\r\n            if (priv.lastStatusId)\r\n                SP.UI.Status.removeStatus(priv.lastStatusId);\r\n            priv.lastStatusId = SP.UI.Notify.addNotification(text, fixed == true);\r\n        }\r\n        //SP.UI.Status.addStatus(\"Status good!\") SP.UI.Status.setStatusPriColor(statusId, 'red');     SP.UI.Status.removeStatus(statusId);\r\n    }\r\n\r\n    // Если это документ, то откроем в отдельной закладке и в owa\r\n    function getLink(link) {\r\n        if (link) {\r\n            var linkUrl = link.Url ? link.Url : link;\r\n            if (linkUrl.search(/\\.pdf$|\\.doc$|\\.xls$|\\.ppt$|\\.docx$|\\.xlsx$|\\.pptx$/ig) !== -1) {\r\n                return linkUrl.split('?')[0] + '?Web=1';\r\n            } else {\r\n                return linkUrl;\r\n            }\r\n        }\r\n\r\n        return '#';\r\n    }\r\n\r\n    // Если это документ, то откроем в отдельной закладке\r\n    function getTarget(link) {\r\n        if (getLink(link).search(/Web=1$/ig) !== -1) {\r\n            return '_blank';\r\n        }\r\n        else\r\n            return '_self';\r\n    }\r\n\r\n    function getHashTagLink(hashTagId) {\r\n        return getWebUrl() + '/SitePages/search.aspx?#q=&advanced=1&hashtags=' + hashTagId;\r\n    }\r\n\r\n    /**\r\n     * http://stackoverflow.com/questions/2353211/hsl-to-rgb-color-conversion\r\n     *\r\n     * Converts an HSL color value to RGB. Conversion formula\r\n     * adapted from http://en.wikipedia.org/wiki/HSL_color_space.\r\n     * Assumes h, s, and l are contained in the set [0, 1] and\r\n     * returns r, g, and b in the set [0, 255].\r\n     *\r\n     * @param   Number  h       The hue\r\n     * @param   Number  s       The saturation\r\n     * @param   Number  l       The lightness\r\n     * @return  Array           The RGB representation\r\n     */\r\n    function hslToRgb(h, s, l) {\r\n        var r, g, b;\r\n\r\n        if (s == 0) {\r\n            r = g = b = l; // achromatic\r\n        } else {\r\n            function hue2rgb(p, q, t) {\r\n                if (t < 0) t += 1;\r\n                if (t > 1) t -= 1;\r\n                if (t < 1 / 6) return p + (q - p) * 6 * t;\r\n                if (t < 1 / 2) return q;\r\n                if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\r\n                return p;\r\n            }\r\n\r\n            var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\r\n            var p = 2 * l - q;\r\n            r = hue2rgb(p, q, h + 1 / 3);\r\n            g = hue2rgb(p, q, h);\r\n            b = hue2rgb(p, q, h - 1 / 3);\r\n        }\r\n\r\n        return [Math.floor(r * 255), Math.floor(g * 255), Math.floor(b * 255)];\r\n    }\r\n\r\n    // Делаю свою функцию setCookie (копия из docflow), т.к. в функции в docflow ошибка, из-за которой нельзя указать szPath\r\n    function setCookie(szName, szValue, uDaysExpires, szPath) {\r\n        var dtExpires = new Date();\r\n        var szExpireDate = '';\r\n\r\n        if (szPath == '') szPath = \"/\";\r\n\r\n        dtExpires.setTime(dtExpires.getTime() + uDaysExpires * 24 * 60 * 60 * 1000);\r\n        szExpireDate = dtExpires.toGMTString();\r\n        szValue = encodeURI(szValue);\r\n        document.cookie = szName + '=' + szValue + '; path=' + szPath + '; expires=' + szExpireDate;\r\n    }\r\n\r\n    // возвращает cookie с именем name, если есть, если нет, то undefined\r\n    function getCookie(name) {\r\n        var matches = document.cookie.match(new RegExp(\r\n            \"(?:^|; )\" + name.replace(/([\\.$?*|{}\\(\\)\\[\\]\\\\\\/\\+^])/g, '\\\\$1') + \"=([^;]*)\"\r\n        ));\r\n        return matches ? decodeURIComponent(matches[1]) : undefined;\r\n    }\r\n\r\n    // Создание элемента в списке\r\n    function getSetting(name, callback) {\r\n        var deferred = jQuery.Deferred();\r\n\r\n        SP.SOD.executeFunc('sp.js', 'SP.ClientContext', () => {\r\n            SPServices.getJsomListItems(\"\", \"Настройки\", \"<View Scope='Recursive'><Query></Query></View>\")\r\n                .then(items => {\r\n\r\n                    var item = items.filter(item => item.Title === name);\r\n                    if (item.length == 1)\r\n                        callback(item[0].SettingsValue);\r\n\r\n                })\r\n                .catch(error =>\r\n                    console.log('Не удалось получить данные из списка Настройки для ' + name + \" \" + error)\r\n                );\r\n        });\r\n    }\r\n\r\n    function isInEditMode() {\r\n\r\n        var inDesignMode = document.forms[MSOWebPartPageFormName].MSOLayout_InDesignMode;\r\n        inDesignMode = inDesignMode == undefined ? null : document.forms[MSOWebPartPageFormName].MSOLayout_InDesignMode.value;\r\n        if (inDesignMode == \"1\") { return true; }\r\n        var wikiInEditMode = document.forms[MSOWebPartPageFormName]._wikiPageMode;\r\n        wikiInEditMode = wikiInEditMode == undefined ? null : document.forms[MSOWebPartPageFormName]._wikiPageMode.value;\r\n        if (wikiInEditMode == \"Edit\") { return true; }\r\n        else { return false; }\r\n    }\r\n\r\n    function OpenModalDialog(strPageURL, width, height) {\r\n        var dialogOptions = SP.UI.$create_DialogOptions();\r\n        dialogOptions.url = strPageURL; // URL of the Page               \r\n        // Width of the Dialog  \r\n        dialogOptions.width = width;\r\n        // Height of the Dialog  \r\n        dialogOptions.height = height;\r\n        // Function to capture dialog closed event  \r\n        //dialogReturnValueCallback - A function pointer that specifies the return callback function. The function takes two parameters, a dialogResult of type SP.UI.DialogResult Enumeration and a returnValue of type object that contains any data returned by the dialog.  \r\n        //dialogOptions.dialogReturnValueCallback = Function.createDelegate(null, CloseCallback);  \r\n        // Open the Dialog  \r\n        SP.UI.ModalDialog.showModalDialog(dialogOptions);\r\n        return false;\r\n\r\n\r\n    }\r\n\r\n\r\n\r\n    return {\r\n        getWebUrl: getWebUrl,\r\n        getSiteUrl: getSiteUrl,\r\n        getStringParamsFromObject: getStringParamsFromObject,\r\n        getWebApiUrlList: getWebApiUrlList,\r\n        isImage: isImage,\r\n        getUrlParameterByName: getUrlParameterByName,\r\n        getListItemById: getListItemById,\r\n        createListItem: createListItem,\r\n        deleteListItem: deleteListItem,\r\n        updateListItem: updateListItem,\r\n        getJsomListItems: getJsomListItems,\r\n        isUserInGroups: isUserInGroups,\r\n        addNotification: addNotification,\r\n        getLink: getLink,\r\n        getTarget: getTarget,\r\n        getHashTagLink: getHashTagLink,\r\n        hslToRgb: hslToRgb,\r\n        setCookie: setCookie,\r\n        getCookie: getCookie,\r\n        getSetting: getSetting,\r\n        isInEditMode: isInEditMode,\r\n        OpenModalDialog: OpenModalDialog\r\n    }\r\n}());\r\n\r\n\r\n"],"sourceRoot":""}